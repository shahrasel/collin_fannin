jQuery(document).ready(function(){GRACE_CHURCH_GLOBALS.to_media_frame=[];grace_church_options_init(jQuery(".grace_church_options_body"));grace_church_options_fix_scroll_menu();jQuery(".grace_church_options").on("click",".grace_church_options_button_save",function(c){if(typeof(tinymce)!="undefined"){var a=tinymce.activeEditor;if(a!=null&&"mce_fullscreen"==a.id){tinymce.get("content").setContent(a.getContent({format:"raw"}),{format:"raw"})}tinymce.triggerSave()}var b={action:"grace_church_options_save",nonce:GRACE_CHURCH_GLOBALS.ajax_nonce,data:jQuery(".grace_church_options_form").serialize(),override:GRACE_CHURCH_GLOBALS.to_override,slug:GRACE_CHURCH_GLOBALS.to_slug,mode:"save"};setTimeout(function(){grace_church_message_info(GRACE_CHURCH_GLOBALS.to_override=="customizer"?GRACE_CHURCH_GLOBALS.to_strings["recompile_styles"]:"",GRACE_CHURCH_GLOBALS.to_strings["wait"],"spin3 animate-spin",60000)},600);jQuery.post(GRACE_CHURCH_GLOBALS.ajax_url,b,function(d){grace_church_message_success(GRACE_CHURCH_GLOBALS.to_override=="customizer"?GRACE_CHURCH_GLOBALS.to_strings["reload_page"]:"",GRACE_CHURCH_GLOBALS.to_strings["save_options"]);if(GRACE_CHURCH_GLOBALS.to_override=="customizer"){setTimeout(function(){location.reload()},3000)}});c.preventDefault();return false});jQuery(".grace_church_options").on("click",".grace_church_options_button_reset",function(a){grace_church_message_confirm(GRACE_CHURCH_GLOBALS.to_strings["reset_options_confirm"],GRACE_CHURCH_GLOBALS.to_strings["reset_options"],function(b){if(b!=1){return}var c={action:"grace_church_options_save",nonce:GRACE_CHURCH_GLOBALS.ajax_nonce,override:GRACE_CHURCH_GLOBALS.to_override,slug:GRACE_CHURCH_GLOBALS.to_slug,mode:"reset"};setTimeout(function(){grace_church_message_info(GRACE_CHURCH_GLOBALS.to_override=="customizer"?GRACE_CHURCH_GLOBALS.to_strings["recompile_styles"]:"",GRACE_CHURCH_GLOBALS.to_strings["wait"],"spin3 animate-spin",60000)},600);jQuery.post(GRACE_CHURCH_GLOBALS.ajax_url,c,function(d){grace_church_message_success(GRACE_CHURCH_GLOBALS.to_strings["reset_options_complete"]+"<br>"+GRACE_CHURCH_GLOBALS.to_strings["reload_page"],GRACE_CHURCH_GLOBALS.to_strings["reset_options"]);setTimeout(function(){location.reload()},3000)})});a.preventDefault();return false});jQuery(".grace_church_options").on("click",".grace_church_options_button_export,.grace_church_options_button_import",function(h){var g="import";if(jQuery(this).hasClass("grace_church_options_button_export")){g="export";if(typeof(tinymce)!="undefined"){var f=tinymce.activeEditor;if(f!=null&&"mce_fullscreen"==f.id){tinymce.get("content").setContent(f.getContent({format:"raw"}),{format:"raw"})}tinymce.triggerSave()}}var d='<div class="grace_church_options_export_set_name"><form>'+(g=="import"?"":'<div class="grace_church_options_export_name_area"><label for="grace_church_options_export_name">'+GRACE_CHURCH_GLOBALS.to_strings["export_options_label"]+'</label><input id="grace_church_options_export_name" name="grace_church_options_export_name" class="grace_church_options_export_name" type="text"></div>');var b=GRACE_CHURCH_GLOBALS.to_export_list;if(b.length>0){d+='<div class="grace_church_options_export_name2_area"><label for="grace_church_options_export_name2">'+(g=="import"?GRACE_CHURCH_GLOBALS.to_strings["export_options_label"]:GRACE_CHURCH_GLOBALS.to_strings["export_options_label2"])+'</label><select id="grace_church_options_export_name2" name="grace_church_options_export_name2" class="grace_church_options_export_name2"><option value="">'+GRACE_CHURCH_GLOBALS.to_strings["export_options_select"]+"</option>";for(var c=0;c<b.length;c++){d+='<option value="'+b[c]+'">'+b[c]+"</option>"}d+="</select></div>"}else{if(g=="import"){d+='<div class="grace_church_options_export_empty">'+GRACE_CHURCH_GLOBALS.to_strings["export_empty"]+"</div>"}}if(g=="import"){d+='<div class="grace_church_options_export_textarea"><label for="grace_church_options_export_data">'+GRACE_CHURCH_GLOBALS.to_strings["import_options_label"]+'</label><textarea id="grace_church_options_export_data" name="grace_church_options_export_data" class="grace_church_options_export_data"></textarea></div>'}d+="</form></div>";var a=grace_church_message_dialog(d,g=="import"?GRACE_CHURCH_GLOBALS.to_strings["import_options_header"]:GRACE_CHURCH_GLOBALS.to_strings["export_options_header"],function(e){},function(i,e){if(i!=1){return}var k=a.find("#grace_church_options_export_name2").val();if(g=="import"){var n=a.find("#grace_church_options_export_data").val();if(k==""&&n==""){grace_church_message_warning(GRACE_CHURCH_GLOBALS.to_strings["import_options_error"],GRACE_CHURCH_GLOBALS.to_strings["import_options_header"]);return}var l={action:"grace_church_options_import",nonce:GRACE_CHURCH_GLOBALS.ajax_nonce,name2:k,text:n,override:GRACE_CHURCH_GLOBALS.to_override,slug:GRACE_CHURCH_GLOBALS.to_slug};jQuery.post(GRACE_CHURCH_GLOBALS.ajax_url,l,function(o){var p=JSON.parse(o);if(p.error===""){grace_church_options_import_values(p.data);grace_church_message_success(GRACE_CHURCH_GLOBALS.to_strings["import_options"],GRACE_CHURCH_GLOBALS.to_strings["import_options_header"])}else{grace_church_message_warning(GRACE_CHURCH_GLOBALS.to_strings["import_options_failed"],GRACE_CHURCH_GLOBALS.to_strings["import_options_header"])}})}else{var m=a.find("#grace_church_options_export_name").val();if(m==""&&k==""){grace_church_message_warning(GRACE_CHURCH_GLOBALS.to_strings["export_options_error"],GRACE_CHURCH_GLOBALS.to_strings["export_options_header"]);return}var j=null;if(jQuery("form.grace_church_options_form").length===1){j=jQuery("form.grace_church_options_form")}else{if(jQuery("form#addtag").length===1){j=jQuery("form#addtag")}else{if(jQuery("form#edittag").length===1){j=jQuery("form#edittag")}else{if(jQuery("form#post").length===1){j=jQuery("form#post")}}}}var l={action:"grace_church_options_save",nonce:GRACE_CHURCH_GLOBALS.ajax_nonce,data:j.serialize(),name:m,name2:k,mode:"export",override:GRACE_CHURCH_GLOBALS.to_override,slug:GRACE_CHURCH_GLOBALS.to_slug};jQuery.post(GRACE_CHURCH_GLOBALS.ajax_url,l,function(o){var q=JSON.parse(o);grace_church_message_success(GRACE_CHURCH_GLOBALS.to_strings["export_options"]+"<br>"+GRACE_CHURCH_GLOBALS.to_strings["export_link"].replace("%s",'<br><a target="_blank" href="'+q.link+'">'+GRACE_CHURCH_GLOBALS.to_strings["export_download"]+"</a>"),GRACE_CHURCH_GLOBALS.to_strings["export_options_header"]);if(m!=""){if(k!=""){for(var p=0;p<GRACE_CHURCH_GLOBALS.to_export_list.length;p++){if(GRACE_CHURCH_GLOBALS.to_export_list[p]==k){GRACE_CHURCH_GLOBALS.to_export_list[p]=m;break}}}else{GRACE_CHURCH_GLOBALS.to_export_list.push(m)}}})}});h.preventDefault();return false})});function grace_church_options_init(b){GRACE_CHURCH_GLOBALS.to_body=b;b.find(".wp-editor-area").each(function(){jQuery(this).attr("data-param",jQuery(this).attr("id"))});b.find("[data-param]").change(function(){var d=jQuery(this).parents(".grace_church_options_tab_content");if(d.length==0){d=jQuery(this).parents(".grace_church_options_partition_content")}grace_church_options_check_dependency(d)});grace_church_options_popup_init(b);b.find(".grace_church_options_tab,.grace_church_options_partition").tabs({create:function(f,d){if(d.panel){grace_church_options_init_hidden_elements(d.panel);if(window.grace_church_init_hidden_elements){grace_church_init_hidden_elements(d.panel)}}},activate:function(f,d){if(d.newPanel){grace_church_options_init_hidden_elements(d.newPanel);if(window.grace_church_init_hidden_elements){grace_church_init_hidden_elements(d.newPanel)}}}});b.find(".grace_church_options_accordion").accordion({header:".grace_church_options_accordion_header",collapsible:true,heightStyle:"content",create:function(f,d){if(d.panel){grace_church_options_init_hidden_elements(d.panel);if(window.grace_church_init_hidden_elements){grace_church_init_hidden_elements(d.panel)}}},activate:function(f,d){if(d.newPanel){grace_church_options_init_hidden_elements(d.newPanel);if(window.grace_church_init_hidden_elements){grace_church_init_hidden_elements(d.newPanel)}}}});b.on("click",".grace_church_options_toggle .grace_church_options_toggle_header",function(){if(jQuery(this).hasClass("ui-state-active")){jQuery(this).removeClass("ui-state-active");jQuery(this).siblings("div").slideUp()}else{jQuery(this).addClass("ui-state-active");jQuery(this).siblings("div").slideDown();grace_church_options_init_hidden_elements(jQuery(this));if(window.grace_church_init_hidden_elements){grace_church_init_hidden_elements(jQuery(this))}}});b.find(".grace_church_options_input_masked").each(function(){jQuery(this).mask(""+jQuery(this).data("mask"))});b.find(".grace_church_options_input_date").each(function(){var e=jQuery(this).data("linked-field");var d=e?jQuery("#"+e).val():jQuery(this).val();jQuery(this).datepicker({dateFormat:jQuery(this).data("format"),numberOfMonths:jQuery(this).data("months"),gotoCurrent:true,changeMonth:true,changeYear:true,defaultDate:d,onSelect:function(g,f){var h=jQuery(this).data("linked-field");if(!grace_church_empty(h)){jQuery("#"+h).val(g).trigger("change")}else{f.input.trigger("change")}}})});b.on("click",".grace_church_options_field_spinner .grace_church_options_arrow_up,.grace_church_options_field_spinner .grace_church_options_arrow_down",function(){var i=jQuery(this).parent().siblings("input");var e=i.data("step")?String(i.data("step")):"1";var d=e.indexOf(".")==-1?0:e.length-e.indexOf(".")-1;e=Math.round((jQuery(this).hasClass("grace_church_options_arrow_up")?1:-1)*parseFloat(e)*Math.pow(10,d))/Math.pow(10,d);var f=i.data("min");var h=i.data("max");var g=Math.round((isNaN(i.val())?0:parseFloat(i.val())+e)*Math.pow(10,d))/Math.pow(10,d);if(!isNaN(h)&&g>h){g=h}if(!isNaN(f)&&g<f){g=f}i.val(g).trigger("change")});b.find(".grace_church_options_field_tags .grace_church_options_field_content").sortable({items:"span",update:function(e,f){var d="";f.item.parent().find(".grace_church_options_tag").each(function(){d+=(d?GRACE_CHURCH_GLOBALS.to_delimiter:"")+jQuery(this).text()});f.item.siblings('input[type="hidden"]').eq(0).val(d).trigger("change")}}).disableSelection();b.on("keypress",'.grace_church_options_field_tags input[type="text"]',function(d){if(d.which===44){a(jQuery(this));d.preventDefault();return false}});b.on("keydown",'.grace_church_options_field_tags input[type="text"]',function(d){if(d.which===13){a(jQuery(this));d.preventDefault();return false}});function a(e){if(e.val().trim()!=""){var f=e.val().trim();e.before('<span class="grace_church_options_tag iconadmin-cancel">'+f+"</span>");var d=e.next().val();e.next().val(d+(d?GRACE_CHURCH_GLOBALS.to_delimiter:"")+f).trigger("change");e.val("")}}b.on("click",".grace_church_options_field_tags .grace_church_options_field_content span",function(f){var g=jQuery(this).text();var d=jQuery(this).siblings('input[type="hidden"]').eq(0).val()+GRACE_CHURCH_GLOBALS.to_delimiter;d=d.replace(g+GRACE_CHURCH_GLOBALS.to_delimiter,"");d=d.substring(0,d.length-1);jQuery(this).siblings('input[type="hidden"]').eq(0).val(d).trigger("change");jQuery(this).siblings('input[type="text"]').focus();jQuery(this).remove();f.preventDefault();return false});b.on("click",".grace_church_options_field_tags .grace_church_options_field_content",function(d){jQuery(this).find('input[type="text"]').focus();d.preventDefault();return false});b.on("change",".grace_church_options_field_checkbox input",function(d){jQuery(this).next("label").eq(0).toggleClass("grace_church_options_state_checked");if(jQuery(this).next("label").eq(0).hasClass("grace_church_options_state_checked")){jQuery(this).attr("checked","checked")}else{jQuery(this).removeAttr("checked")}d.preventDefault();return false});b.on("change",'.grace_church_options_field_radio input[type="radio"]',function(d){jQuery(this).parent().parent().find("label").removeClass("grace_church_options_state_checked").find("span").removeClass("iconadmin-dot-circled");jQuery(this).parent().parent().find("input:checked").next("label").eq(0).addClass("grace_church_options_state_checked").find("span").addClass("iconadmin-dot-circled");jQuery(this).parent().parent().find('input[type="hidden"]').val(jQuery(this).parent().parent().find("input:checked").val()).trigger("change");d.preventDefault();return false});b.on("click",".grace_church_options_field_switch .grace_church_options_switch_inner",function(f){var g=parseInt(jQuery(this).css("marginLeft"))==0?2:1;var d=jQuery(this).find("span").eq(g-1).data("value");jQuery(this).parent().siblings('input[type="hidden"]').eq(0).val(d).trigger("change");jQuery(this).parent().toggleClass("grace_church_options_state_off",g==2);f.preventDefault();return false});b.on("click",".grace_church_options_field_checklist .grace_church_options_listitem",function(f){var d=jQuery(this).parents(".grace_church_options_field_checklist").hasClass("grace_church_options_multiple");if(!d){jQuery(this).siblings(".grace_church_options_listitem").removeClass("grace_church_options_state_checked")}jQuery(this).toggleClass("grace_church_options_state_checked");c(jQuery(this).parent());f.preventDefault();return false});b.find(".grace_church_options_field_checklist.grace_church_options_multiple .grace_church_options_field_content").sortable({update:function(d,e){c(e.item.parent())}}).disableSelection();b.on("click",".grace_church_options_field_select .grace_church_options_input,.grace_church_options_field_select .grace_church_options_field_after,.grace_church_options_field_images .grace_church_options_caption_image,.grace_church_options_field_icons .grace_church_options_caption_icon",function(d){jQuery(this).siblings(".grace_church_options_input_menu").slideToggle();d.preventDefault();return false});b.on("click",".grace_church_options_field .grace_church_options_menuitem",function(f){var d=jQuery(this).parents(".grace_church_options_field").hasClass("grace_church_options_multiple");if(!d){jQuery(this).siblings(".grace_church_options_menuitem").removeClass("grace_church_options_state_checked");jQuery(this).addClass("grace_church_options_state_checked")}else{jQuery(this).toggleClass("grace_church_options_state_checked")}c(jQuery(this).parent());if(!d&&!jQuery(this).parent().hasClass("grace_church_options_input_menu_list")){jQuery(this).parent().slideToggle()}f.preventDefault();return false});b.find(".grace_church_options_field.grace_church_options_multiple .grace_church_options_input_menu").sortable({update:function(d,e){c(e.item.parent())}}).disableSelection();function c(h){var k="",e="",j="",g="";h.find(".grace_church_options_menuitem,.grace_church_options_listitem").each(function(){if(jQuery(this).hasClass("grace_church_options_state_checked")){k+=(k?GRACE_CHURCH_GLOBALS.to_delimiter:"")+jQuery(this).data("value");var l=jQuery(this).find(".grace_church_options_input_image");if(l.length>0){j=l.eq(0).data("src")}else{if(jQuery(this).parents(".grace_church_options_field_icons").length>0){g=jQuery(this).data("value")}else{e+=(e?GRACE_CHURCH_GLOBALS.to_delimiter:"")+jQuery(this).html()}}}});h.parent().find('input[type="hidden"]').eq(0).val(k).trigger("change");if(e!=""){h.parent().find('input[type="text"]').eq(0).val(e)}if(j!=""){h.parent().find(".grace_church_options_caption_image span").eq(0).css("backgroundImage","url("+j+")")}if(g!=""){var i=h.parent().find(".grace_church_options_input_socials");if(i.length>0){var f=i.next();var d=f.attr("class");d=(d.indexOf(" icon")>0?d.substr(0,d.indexOf(" icon")):d)+" "+g;f.removeClass().addClass(d).trigger("change")}else{h.parent().find(".grace_church_options_caption_icon span").eq(0).removeClass().addClass(g).trigger("change")}}}if(b.find(".grace_church_options_input_color_wp").length>0){b.find(".grace_church_options_input_color_wp").wpColorPicker({change:function(f,d){jQuery(f.target).val(d.color).trigger("change")},clear:function(d){jQuery(d.target).prev().trigger("change")}})}if(b.find(".grace_church_options_input_color_tiny").length>0){b.find(".grace_church_options_input_color_tiny").colorPicker({animationSpeed:0,margin:"1px 0 0 0",cssAddon:".cp-color-picker { background-color: #ddd; z-index:1000; }",renderCallback:function(e,h){var d=this.color.colors,g=d.RND.rgb,f=d.alpha==1?"#"+d.HEX:"rgba("+g.r+", "+g.g+", "+g.b+", "+(Math.round(d.alpha*100)/100)+")";e.val(f).data("last-color",f)}})}if(b.find(".grace_church_options_input_color + .iColorPicker").length>0){grace_church_color_picker();b.find(".grace_church_options_input_color + .iColorPicker").each(function(){jQuery(this).click(function(f){grace_church_color_picker_show(null,jQuery(this),function(h,g){h.css("backgroundColor",g);h.siblings("input").attr("value",g).trigger("change")})});var d=jQuery(this).prev();var e=d.val();if(e!=""){jQuery(this).css("backgroundColor",e)}d.change(function(){jQuery(this).next().css("backgroundColor",jQuery(this).val())})})}b.on("click",".grace_church_options_clone_button_add",function(i){var h=jQuery(this).parents(".grace_church_options_cloneable_area").eq(0);var g=null;var f=0;h.find(".grace_church_options_cloneable_item").each(function(){var j=jQuery(this);if(g==null){g=j}var e=Number(j.find('input[name*="_numbers[]"]').eq(0).val());if(e>f){f=e}});var d=g.clone();d.find('input[type="text"],textarea').val("");d.find('input[name*="_numbers[]"]').val(f+1);jQuery(this).before(d);i.preventDefault();return false});b.on("click",".grace_church_options_clone_button_del",function(d){if(jQuery(this).parents(".grace_church_options_cloneable_item").parent().find(".grace_church_options_cloneable_item").length>1){jQuery(this).parents(".grace_church_options_cloneable_item").eq(0).remove()}else{grace_church_message_warning(GRACE_CHURCH_GLOBALS.to_strings["del_item_error"],GRACE_CHURCH_GLOBALS.to_strings["del_item"])}d.preventDefault();return false});b.on("click",".grace_church_options_button_inherit",function(f){var d=!jQuery(this).hasClass("grace_church_options_inherit_off");if(d){jQuery(this).addClass("grace_church_options_inherit_off");jQuery(this).parents(".grace_church_options_field").find(".grace_church_options_content_inherit").fadeOut().find("input").val("")}else{jQuery(this).removeClass("grace_church_options_inherit_off");jQuery(this).parents(".grace_church_options_field").find(".grace_church_options_content_inherit").fadeIn().find("input").val("inherit")}f.preventDefault();return false});b.on("click",".grace_church_options_content_inherit",function(d){jQuery(this).parents(".grace_church_options_field").find(".grace_church_options_button_inherit").addClass("grace_church_options_inherit_off");jQuery(this).fadeOut().find("input").val("");d.preventDefault();return false})}function grace_church_options_action_media_upload(e){var b=jQuery(e);var d=b.data("linked-field")?jQuery("#"+b.data("linked-field")).eq(0):b.siblings("input");var a=d.attr("id");if(GRACE_CHURCH_GLOBALS.to_media_frame[a]){GRACE_CHURCH_GLOBALS.to_media_frame[a]["field"]=d;GRACE_CHURCH_GLOBALS.to_media_frame[a]["frame"].open();return}GRACE_CHURCH_GLOBALS.to_media_frame[a]=[];GRACE_CHURCH_GLOBALS.to_media_frame[a]["field"]=d;GRACE_CHURCH_GLOBALS.to_media_frame[a]["sizes"]=b.data("sizes");GRACE_CHURCH_GLOBALS.to_media_frame[a]["multi"]=b.data("multiple");var c={frame:"post",multiple:GRACE_CHURCH_GLOBALS.to_media_frame[a]["multi"]?"add":false,title:b.data("caption-choose"),library:{type:b.data("type")?b.data("type"):"image"},button:{text:b.data("caption-update"),close:true}};GRACE_CHURCH_GLOBALS.to_media_frame[a]["frame"]=wp.media(c);GRACE_CHURCH_GLOBALS.to_media_frame[a]["frame"].on("insert select",function(k){var j="",m=-1,n=false;if(GRACE_CHURCH_GLOBALS.to_media_frame[a]["multi"]){GRACE_CHURCH_GLOBALS.to_media_frame[a]["frame"].state().get("selection").map(function(p){i+=(i?"\n":"")+p.toJSON().url});var h=GRACE_CHURCH_GLOBALS.to_media_frame[a]["field"].val();j=h+(h?"\n":"")+i}else{var i=GRACE_CHURCH_GLOBALS.to_media_frame[a]["frame"].state().get("selection").first().toJSON();var l=jQuery(".media-modal-content .attachment-display-settings select.size");if(GRACE_CHURCH_GLOBALS.to_media_frame[a]["sizes"]&&l.length>0){var o=grace_church_get_listbox_selected_value(l.get(0));if(o!=""){j=i.sizes[o].url}}if(j==""){j=i.url}if(!b.data("linked-field")){var g="";if((m=j.lastIndexOf("."))>=0){var f=j.substr(m+1);g='<a class="grace_church_options_image_preview" rel="popupImage" target="_blank" href="'+j+'">';if("jpg,png,gif".indexOf(f)>=0){g+='<img src="'+j+'" alt="" rel="popupImage" />';n=true}else{g+="<span>"+j.substr(j.lastIndexOf("/")+1)+"</span>"}g+="</a>"}b.siblings(".grace_church_options_image_preview").remove();if(g!=""){b.parent().append(g);if(n){grace_church_options_popup_init(GRACE_CHURCH_GLOBALS.to_body)}}}}GRACE_CHURCH_GLOBALS.to_media_frame[a]["field"].val(j).trigger("change")});GRACE_CHURCH_GLOBALS.to_media_frame[a]["frame"].open()}function grace_church_options_action_media_reset(c){var a=jQuery(c);var b=a.data("linked-field")?jQuery("#"+a.data("linked-field")).eq(0):a.siblings("input");a.siblings(".grace_church_options_image_preview").remove();b.val("").trigger("change")}function grace_church_options_action_color_reset(c){var a=jQuery(c);var b=a.data("linked-field")?jQuery("#"+a.data("linked-field")).eq(0):a.siblings("input");b.val("").css("backgroundColor","#ffffff").trigger("change")}function grace_church_options_action_select_icon(c){var a=jQuery(c);var b=a.data("linked-field")?jQuery("#"+a.data("linked-field")).eq(0):a.siblings('input[type="hidden"]').eq(0);a.siblings(".grace_church_options_input_menu").slideToggle()}function grace_church_options_action_show_menu(a){}function grace_church_options_action_clear_cache(b){var a={action:"grace_church_options_clear_cache",nonce:GRACE_CHURCH_GLOBALS.ajax_nonce};jQuery.post(GRACE_CHURCH_GLOBALS.ajax_url,a,function(c){grace_church_message_success(GRACE_CHURCH_GLOBALS.to_strings["clear_cache"],GRACE_CHURCH_GLOBALS.to_strings["clear_cache_header"])})}function grace_church_options_popup_init(a){a.find("a[rel*='popupImage']:not(.inited)").each(function(){if(GRACE_CHURCH_GLOBALS.to_popup=="pretty"){jQuery(this).addClass("inited").prettyPhoto({social_tools:"",theme:"facebook",deeplinking:false})}else{if(GRACE_CHURCH_GLOBALS.to_popup=="magnific"){jQuery(this).addClass("inited").magnificPopup({type:"image",mainClass:"mfp-img-mobile",closeOnContentClick:true,closeBtnInside:true,fixedContentPos:true,midClick:true,preloader:true,image:{verticalFit:true}})}}})}function grace_church_options_init_hidden_elements(a){grace_church_options_check_dependency(a);a.find(".grace_church_options_field_range").each(function(){var j=jQuery(this);var g=j.find(".grace_church_options_range_scale");var b=g.width();if(b<=0){return}var f=parseFloat(j.find(".grace_church_options_input_range").data("step"));var d=Math.pow(10,f.toString().indexOf(".")<0?0:f.toString().length-f.toString().indexOf(".")-1);var m=j.find('.grace_church_options_input_range input[type="hidden"]').eq(0);var e=m.val().split(GRACE_CHURCH_GLOBALS.to_delimiter);var c=parseFloat(j.find(".grace_church_options_range_min").html());var k=parseFloat(j.find(".grace_church_options_range_max").html());var l=b/((k-c)/f);var h=0;j.find(".grace_church_options_range_slider").each(function(){var i=e.length==1||h==1?"width":"left";jQuery(this).css("left",(e[h]-c)*l/f+"px");g.find("span").css(i,((e[h]-c)*l/f-(h==1?(e[0]-c)*l/f:0))+"px");h++});if(!j.hasClass("inited")){j.addClass("inited").find(".grace_church_options_range_slider").draggable({axis:"x",grid:[l,l],containment:".grace_church_options_input_range",scroll:false,drag:function(r,p){var q=j.find('.grace_church_options_input_range input[type="hidden"]').eq(0);var s=q.val().split(GRACE_CHURCH_GLOBALS.to_delimiter);var o=p.helper;var i=o.index()-1;var n=Math.min(k,Math.max(c,Math.round(p.position.left/l*f*d)/d+c));if(s.length==2){if(i==0&&n>s[1]){n=s[1];p.position.left=(n-c)*l/f}if(i==1&&n<s[0]){n=s[0];p.position.left=(n-c)*l/f}}if(s[i]!=n){o.find(".grace_church_options_range_slider_value").html(n);s[i]=n;q.val(s.join(GRACE_CHURCH_GLOBALS.to_delimiter)).trigger("change");if(s.length==2){g.find("span").css("left",(s[0]-c)*l/f+"px")}g.find("span").css("width",((s[s.length==2?1:0]-c)*l/f-(s.length==2?(s[0]-c)*l/f:0))+"px")}}})}})}function grace_church_options_check_dependency(a){if(a.parents(".grace_church_shortcodes_body").length==1){if(typeof GRACE_CHURCH_GLOBALS.shortcodes=="undefined"){return}var c=GRACE_CHURCH_GLOBALS.shortcodes_current_idx;if(c==""){return}var d=GRACE_CHURCH_GLOBALS.shortcodes[c]}else{if(a.parents(".grace_church_options_body").length==1){if(typeof GRACE_CHURCH_GLOBALS.to_options=="undefined"){return}var d=GRACE_CHURCH_GLOBALS.to_options}else{return}}var b=a.parents(".grace_church_options_tab");if(b.length==0){b=a}a.find("[data-param]").each(function(){var o=jQuery(this);var g=o.data("param");var p=o.attr("type")!="checkbox"||o.get(0).checked?o.val():"";var e=false;if(typeof d.params!="undefined"&&typeof d.params[g]!="undefined"&&typeof d.params[g].dependency!="undefined"){e=d.params[g].dependency}if(e===false&&typeof d.children!="undefined"&&typeof d.children.params!="undefined"&&typeof d.children.params[g]!="undefined"&&typeof d.children.params[g].dependency!="undefined"){e=d.children.params[g].dependency}if(e===false&&typeof d[g]!="undefined"&&typeof d[g].dependency!="undefined"){e=d[g].dependency}if(e){var q=0,n=0;var l=typeof e.compare!="undefined"?e.compare.toLowerCase():"and";var h=null,f="";for(var m in e){if(m=="compare"){continue}n++;h=b.find('[data-param="'+m+'"]');if(h.length>0){f=h.attr("type")!="checkbox"||h.get(0).checked?h.val():"";for(var k in e[m]){if((e[m][k]=="not_empty"&&f!="")||(e[m][k]=="is_empty"&&f=="")||(e[m][k]=="refresh"&&grace_church_options_refresh_field(o,m,f))||(f!=""&&f.indexOf(e[m][k])==0)){q++;break}}}if(q>0&&l=="or"){break}}if((q>0&&l=="or")||(q==n&&l=="and")){o.parents(".grace_church_options_field").show().removeClass("grace_church_options_no_use")}else{o.parents(".grace_church_options_field").hide().addClass("grace_church_options_no_use")}}})}jQuery(window).scroll(function(){grace_church_options_fix_scroll_menu()});function grace_church_options_fix_scroll_menu(){var b=jQuery(".grace_church_options_form .grace_church_options_header");if(b.length>0){if(b.data("wrap")!=1){b.wrap('<div class="grace_church_options_header_wrap" style="height:'+b.height()+'px;"></div>');b.attr("data-wrap","1")}var c=jQuery(window).scrollTop();var d=jQuery("#wpadminbar").height();var a=jQuery(".grace_church_options_header").height();if(c>(d+20+a)){jQuery(".grace_church_options_header").addClass("grace_church_options_header_fixed")}else{jQuery(".grace_church_options_header").removeClass("grace_church_options_header_fixed")}}}function grace_church_options_import_values(c){var d="",b="";for(var a in c){if((b=grace_church_options_set_value(a,c[a]))!=""){d+=(d!=""?",<br>":"")+b}}if(d!=""){grace_church_message_warning(GRACE_CHURCH_GLOBALS.to_strings["import_options_broken"]+"<br>"+d,GRACE_CHURCH_GLOBALS.to_strings["import_options_header"])}}function grace_church_options_set_value(b,H){var o="";var d=(typeof H=="object"?"[]":"");var a=jQuery('[name="'+b+d+'"]');if(a.length==0){return false}var n=a.parents(".grace_church_options_field");var e=grace_church_options_get_type(n);var t=a.parents(".grace_church_options_cloneable_area");var v=null;if(t.length>0){t.find(".grace_church_options_cloneable_item").each(function(i){if(i==0){v=jQuery(this);a.eq(0).val("");jQuery(this).find('[name="'+b+'_numbers[]"]').val(0);if(e=="socials"){jQuery(this).find('[name="'+b+'_icon[]"]').val("")}}else{jQuery(this).remove()}})}if(typeof H!="object"||typeof H[0]=="undefined"){H=[H]}var A=0;for(var B in H){if(GRACE_CHURCH_GLOBALS.to_override!="general"){if(H[B]!="inherit"){n.find(".grace_church_options_button_inherit").addClass("grace_church_options_inherit_off");n.find(".grace_church_options_content_inherit").fadeOut().find("input").val("")}else{n.find(".grace_church_options_button_inherit").removeClass("grace_church_options_inherit_off");n.find(".grace_church_options_content_inherit").fadeIn().find("input").val("inherit")}}if(A>0&&t.length>0){var m=v.clone();m.find('input[name*="_numbers[]"]').val(B);t.find(".grace_church_options_clone_button_add").before(m);a=jQuery('[name="'+b+'[]"]')}if(GRACE_CHURCH_GLOBALS.to_override=="general"||H[B]!="inherit"){if(e=="text"||e=="textarea"||e=="hidden"||e=="spinner"){a.eq(A).val(H[B]).trigger("change")}else{if(e=="editor"){a.eq(A).val(H[B]).trigger("change");if(typeof(tinymce)!="undefined"&&typeof(tinymce.editors[b])!="undefined"){tinymce.editors[b].setContent(H[B])}}else{if(e=="date"){n.datepicker("setDate",H[B]);a.eq(A).val(H[B]).trigger("change")}else{if(e=="tags"){a.eq(A).val(H[B]).trigger("change");a.eq(A).parent().find(".grace_church_options_tag").remove();a.eq(A).prev().val("");var q=H[B].split(GRACE_CHURCH_GLOBALS.to_delimiter);for(var z=0;z<q.length;z++){a.eq(A).prev().before('<span class="grace_church_options_tag iconadmin-cancel">'+q[z]+"</span>")}}else{if(e=="checkbox"){a.eq(A).next("label").eq(0).toggleClass("grace_church_options_state_checked",H[B]=="true");if(H[B]=="true"){a.eq(A).attr("checked","checked")}else{a.eq(A).removeAttr("checked")}}else{if(e=="radio"){a.eq(A).removeAttr("checked").parent().parent().find("label").removeClass("grace_church_options_state_checked").find("span").removeClass("iconadmin-dot-circled");a.eq(A).parent().parent().find('input[value="'+H[B]+'"]').attr("checked","checked").next("label").eq(0).addClass("grace_church_options_state_checked").find("span").addClass("iconadmin-dot-circled");a.eq(A).parent().parent().find('input[type="hidden"]').val(H[B]).trigger("change")}else{if(e=="switch"){a.eq(A).val(H[B]).trigger("change");var r=a.siblings(".grace_church_options_switch").find('[data-value="'+H[B]+'"]').index();a.eq(A).siblings(".grace_church_options_switch").toggleClass("grace_church_options_state_off",r==1)}else{if(e=="checklist"){a.eq(A).val(H[B]).trigger("change");a.eq(A).siblings(".grace_church_options_listitem").removeClass("grace_church_options_state_checked");var u=H[B].split(GRACE_CHURCH_GLOBALS.to_delimiter);for(var z=0;z<u.length;z++){a.eq(A).siblings('.grace_church_options_listitem[data-value="'+u[z]+'"]').addClass("grace_church_options_state_checked")}}else{if(e=="media"){a.eq(A).val(H[B]).trigger("change");a.eq(A).siblings(".grace_church_options_image_preview").remove();if(H[B]!=""){var D=H[B].split("/").pop();if(D!=""){var w=D.split(".");var F=w[0];var g=w.length>1?w[1]:"";a.eq(A).after('<a class="grace_church_options_image_preview" rel="prettyPhoto" target="_blank" href="'+H[B]+'">'+("jpg,png,gif".indexOf(g)>=0?'<img src="'+H[B]+'" alt="" />':"<span>"+F+"</span>")+"</a>")}}}else{if(e=="range"){a.eq(A).val(H[B]).trigger("change");var G=n.find(".grace_church_options_range_scale");var k=parseInt(n.find(".grace_church_options_input_range").data("step"));var f=parseInt(n.find(".grace_church_options_range_min").html());var h=parseInt(n.find(".grace_church_options_range_max").html());var E=G.width();var p=E/(h-f)*k;var u=H[B].split(GRACE_CHURCH_GLOBALS.to_delimiter);for(var z=0;z<u.length;z++){var x=a.eq(A).siblings(".grace_church_options_range_slider").eq(z);x.find(".grace_church_options_range_slider_value").html(u[z]);var y=u.length==1||z==1?"width":"left";x.css("left",(u[z]-f)*p+"px");G.find("span").css(y,((u[z]-f)*p-(z==1?(u[0]-f)*p:0))+"px")}}else{if(e=="select"||e=="images"||e=="icons"){a.eq(A).val(H[B]).trigger("change");a.eq(A).siblings(".grace_church_options_input_menu").find(".grace_church_options_menuitem").removeClass("grace_church_options_state_checked");var u=H[B].split(GRACE_CHURCH_GLOBALS.to_delimiter);for(var z=0;z<u.length;z++){a.eq(A).siblings(".grace_church_options_input_menu").find('.grace_church_options_menuitem[data-value="'+u[z]+'"]').addClass("grace_church_options_state_checked");if(e=="images"){var l=a.eq(A).siblings(".grace_church_options_input_menu").find('.grace_church_options_menuitem[data-value="'+u[z]+'"]').find("span").data("src");a.eq(A).siblings(".grace_church_options_caption_image").find("span").css("backgroundImage","url("+l+")")}else{if(e=="icons"){var c=a.eq(A).siblings(".grace_church_options_caption_icon").find("span").attr("class");c=(c.indexOf(" icon")>0?c.substr(0,c.indexOf(" icon")):c)+" "+u[B];a.eq(A).siblings(".grace_church_options_caption_icon").find("span").removeClass().addClass(c)}else{var C=a.eq(A).siblings(".grace_church_options_input_menu").find('.grace_church_options_menuitem[data-value="'+u[z]+'"]').text();a.eq(A).siblings(".grace_church_options_input").val(C)}}}}else{if(e=="socials"){a.eq(A).val(H[B].url).trigger("change");a.eq(A).siblings('[name="social_icons_icon[]"]').val(H[B].icon);a.eq(A).siblings(".grace_church_options_input_menu").find(".grace_church_options_menuitem").removeClass("grace_church_options_state_checked");a.eq(A).siblings(".grace_church_options_input_menu").find('.grace_church_options_menuitem[data-value="'+H[B].icon+'"]').addClass("grace_church_options_state_checked");var s=n.hasClass("grace_church_options_field_images")?"images":"icons";if(s=="images"){a.eq(A).siblings(".grace_church_options_caption_image").find("span").css("backgroundImage","url("+H[B].icon+")")}else{if(s=="icons"){var c=a.eq(A).siblings(".grace_church_options_field_after").attr("class");c=(c.indexOf(" icon")>0?c.substr(0,c.indexOf(" icon")):c)+" "+H[B].icon;a.eq(A).siblings(".grace_church_options_field_after").removeClass().addClass(c)}}}else{if(e=="color"){a.eq(A).val(H[B]).trigger("change")}else{a.eq(A).val(H[B]).trigger("change");if(!o){o=b+" ("+e+") = "+H[B]}}}}}}}}}}}}}}}A++}return o}function grace_church_options_get_type(c){var b=c.attr("class").split(" ");var d="text";for(var a=0;a<b.length;a++){if(b[a].indexOf("grace_church_options_field_")==0){d=b[a].split("_").pop();break}}return d}function grace_church_options_refresh_field(b,a,e){if(a=="post_type"){if(b.data(a)==undefined){b.data(a,e)}else{if(b.data(a)!=e){var c=b;var f=c.prev().slideToggle();var g=f.parent().prev();g.append('<span class="sc_refresh iconadmin-spin3 animate-spin"></span>');var d={action:"grace_church_admin_change_post_type",nonce:GRACE_CHURCH_GLOBALS.ajax_nonce,post_type:e};jQuery.post(GRACE_CHURCH_GLOBALS.ajax_url,d,function(j){var l=JSON.parse(j);if(l.error===""){var h="";for(var k in l.data.ids){h+='<span class="grace_church_options_menuitem ui-sortable-handle" data-value="'+l.data.ids[k]+'">'+l.data.titles[k]+"</span>"}c.data(a,e).val("");f.empty().html(h).slideToggle();g.find("span").remove()}})}}}return true};